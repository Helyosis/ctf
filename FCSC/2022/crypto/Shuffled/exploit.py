import random
from z3 import *

shuffled_flag = b"f668cf029d2dc4234394e3f7a8S9f15f626Cc257Ce64}2dcd93323933d2{F1a1cd29db"

for i in range(257):
    random.seed(i)

    to_shuffle = list(b'FCSC{') + [BitVec(f'{i}', 8) for i in range(len('FCSC{'), len(shuffled_flag) - 1)] + list(b'}')
    assert len(to_shuffle) == len(shuffled_flag)
    random.shuffle(to_shuffle)

    solver = Solver()
    for j in range(len(shuffled_flag)):
        solver.add(shuffled_flag[j] == to_shuffle[j])
        
    if solver.check() == sat:
        print(i)
        flag = [None] * len(shuffled_flag)
        model = solver.model()
        for x in model:
            flag[ int(x.name()) ] = int(str(model[x]))
        print("FCSC{" + bytes(flag[5:-1]).decode() + "}")
        break